let rec map f =
    function
    | [] -> []
    | x :: xs -> f x :: map f xs